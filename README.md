# Game Tracking Bot

Telegram бот для отслеживания игр и их цен. Поддерживает добавление игр из Steam, отслеживание цен и категоризацию игр.

## Возможности

- Добавление игр из Steam
- Автоматический парсинг информации об игре (название, цена, теги)
- Автоматическое отслеживание изменения цен каждые 24 часа
- Уведомления о скидках в выбранных топиках групп
- Категоризация игр
- Удобный просмотр списка игр

## Установка

### Локальная установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd game-bot
```

2. Установите зависимости:
```bash
npm install
```

3. Создайте файл `.env` и добавьте необходимые переменные окружения:
```
BOT_TOKEN=your_telegram_bot_token
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/gamebot?schema=public"
```

4. Инициализируйте базу данных:
```bash
npm run prisma:generate
npm run prisma:migrate
```

### Установка с помощью Docker

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd game-bot
```

2. Создайте файл `.env` и добавьте токен бота:
```
BOT_TOKEN=your_telegram_bot_token
```

3. Запустите контейнеры:
```bash
docker-compose up -d
```

4. Примените миграции базы данных:
```bash
docker-compose exec bot npx prisma migrate deploy
```

## Запуск

### Локальный запуск

Для разработки:
```bash
npm run dev
```

Для продакшена:
1. Соберите проект:
```bash
npm run build
```

2. Запустите бот:
```bash
npm start
```

### Запуск в Docker

```bash
# Запуск
docker-compose up -d

# Просмотр логов
docker-compose logs -f

# Остановка
docker-compose down

# Остановка с удалением данных
docker-compose down -v
```

## Использование

### Настройка бота

1. Добавьте бота в группу с топиками (супергруппу)
2. Создайте топик для уведомлений о скидках
3. В нужном топике используйте команду `/set_notifications`
4. Бот будет отправлять уведомления о скидках в этот топик

### Команды бота

В группе доступны следующие команды:
- `/add` - Добавить новую игру
- `/list` - Показать список игр
- `/check_prices` - Проверить цены
- `/set_notifications` - Настроить уведомления о скидках в текущем топике
- `/remove_notifications` - Отключить уведомления в текущем топике
- `/help` - Показать помощь

### Уведомления о скидках

Бот автоматически проверяет цены на игры каждые 24 часа. Если цена на игру снижается, бот отправит уведомление в настроенный топик группы.

Настройка уведомлений:
1. Перейдите в нужный топик группы
2. Используйте команду `/set_notifications`
3. Бот будет отправлять уведомления о скидках в этот топик
4. Чтобы отключить уведомления в топике, используйте команду `/remove_notifications`

## Технологии

- Node.js
- TypeScript
- Grammy (Telegram Bot Framework)
- Prisma (ORM)
- PostgreSQL
- Docker & Docker Compose
- Cheerio (Web Scraping)